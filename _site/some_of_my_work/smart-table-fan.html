](https://raw.githubusercontent.com/](https://raw.githubusercontent.com/](https://raw.githubusercontent.com/<!DOCTYPE HTML>
<!--
	Strata by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Smart Table Fan</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="/assets/css/main.css" />

		<!-- FAVICONS -->
		<link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png">
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png">
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png">
		<link rel="manifest" href="/favicon_io/site.webmanifest">

	</head>
	<body class="is-preload">

		<!-- Header -->
			<header id="header">
				<div class="inner">
					<a href="/" class="image avatar"><img src="/images/avatar_round.png" alt="" /></a>
					<h1><strong>Peter Rem√∏y Paulsen</strong></h1>
					<h1>
						electrical engineer, <br />
						developer, <br />
						home automation enthusiast, <br />
						tinkerer
					</h1>
				</div>
			</header>

		<!-- Main -->
			<div id="main">
                <div style="text-align: right;">
    <a href="https://github.com/petrepa/HA-Table-Fan" class="icon brands fa-github"><span class="label">Github</span></a>
</div>

<h1 id="smartmqtt-table-fan">Smart/MQTT Table Fan</h1>

<h2 id="why">Why</h2>
<p>For a period it was suddenly extremely warm outside, and therefore warm inside my apartment. I figured that buying a table fan would be the cheapest solution to cool me down, but I could not have a normal table fan. It had to be smart, or able to become smart, with the help of automations. Using <a href="https://github.com/petrepa/Home-AssistantConfig">Home Assistant</a> to controll this, but you can use this with any MQTT service you would like to automate it.
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/HA.png" alt="Home Assistant UI" /></p>

<h2 id="build">Build</h2>
<p>Built this using:</p>
<ul>
  <li><a href="https://www.clasohlson.com/no/Bordvifte/36-6575">Table Fan</a>
    <ul>
      <li>The cheapest table fan I could find (149 NOK at the time), which had two speed settings</li>
    </ul>
  </li>
  <li><a href="http://www.nodemcu.com/index_en.html">NodeMCU</a> V3</li>
  <li><a href="https://www.gearbest.com/5v-relay-_gear/">Relays</a></li>
  <li>Phone Charger
    <ul>
      <li>Regular phone charger I took apart. Took away the USB ports and soldered the 5V directly on the NodeMCU.
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/components.jpg" alt="components" /></li>
    </ul>
  </li>
</ul>

<h3 id="build-process">Build process</h3>
<p>This is the buttons I had to replace with the relays:
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/buttons.jpg" alt="buttons" /></p>

<p>How I planned the components placement in the fan:
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/component_layout.jpg" alt="layout" /></p>

<p>Where I drilled hole to fasten the relays:
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/relayholder.jpg" alt="relayholder" /></p>

<p>Everything ended up fitting within the fan and closed up perfectly.
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/closed.jpg" alt="closed" /></p>

<p>Finished product:
<img src="https://github.com/petrepa/MQTT-Table-Fan/blob/master/mqtt_fan_photos/assembled.jpg" alt="Assembled" /></p>

<p>I plan to later on make a cover for the holes where the buttons used to be, just to make the product a bit more polished. Maybe find a proper way to mount the fan in the roof or something too.</p>
<h4 id="changes">Changes</h4>
<p>Instead of making a cover I decided to put in some buttons to controll the fan manually.
<img src="https://github.com/petrepa/HA-Table-Fan/blob/master/mqtt_fan_photos/assembled_new.jpg" alt="Assembled" />
<img src="https://github.com/petrepa/HA-Table-Fan/blob/master/mqtt_fan_photos/buttons_new.jpg" alt="New Buttons" /></p>
<h2 id="code">Code</h2>
<p>Wrote the code super quick, so there is definetly room for improvements, and I highly encourage you make some! 
But if you want to use what I wrote, you can check it our <a href="https://github.com/petrepa/Dooropener/blob/master/dooropener.ino">here</a>!</p>

<h3 id="converting-to-esphome">Converting to ESPHome</h3>
<p>This project has been converted to ESPHome for better and easier integration with Home Assistant. The yaml can be found <a href="https://github.com/petrepa/HA-Table-Fan/blob/master/table_fan.yaml">here</a>.</p>

			</div>

		<!-- Footer -->
			<footer id="footer">
				<div class="inner">
					<ul class="icons">
						<li><a href="https://twitter.com/petrepa" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
						<li><a href="https://www.facebook.com/petrepa" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
						<li><a href="https://www.reddit.com/user/petrepa/" class="icon brands fab fa-reddit-alien"><span class="label">Reddit</span></a></li>
					</ul>
					<ul class="icons">
						<li><a href="https://www.instagram.com/petrepa/" class="icon brands fab fa-instagram"><span class="label">Instagram</span></a></li>
						<li><a href="https://www.youtube.com/petrepa/" class="icon brands fab fa-youtube"><span class="label">YouTube</span></a></li>
						<li><a href="https://www.strava.com/athletes/petrepa" class="icon brands fab fa-strava"><span class="label">Strava</span></a></li>
					</ul>
					<ul class="icons">
						<li><a href="https://www.linkedin.com/in/petrepa/" class="icon brands fab fa-linkedin"><span class="label">LinkedIn</span></a></li>
						<li><a href="https://www.github.com/petrepa" class="icon brands fa-github"><span class="label">Github</span></a></li>
						<li><a href="mailto: peter.remoy.paulsen@gmail.com" class="icon solid fa-envelope"><span class="label">Email</span></a></li>
						<!-- THINGIVERSE -->
					</ul>
					<ul class="copyright">
						<h4>@petrepa</h4>
						<p>Everywhere. Almost.</p>
					</ul>
				</div>
			</footer>

		<!-- Scripts -->
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.poptrox.min.js"></script>
			<script src="/assets/js/browser.min.js"></script>
			<script src="/assets/js/breakpoints.min.js"></script>
			<script src="/assets/js/util.js"></script>
			<script src="/assets/js/main.js"></script>

	</body>
</html>
